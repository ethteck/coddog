"use strict";(self.webpackChunkcoddog=self.webpackChunkcoddog||[]).push([["698"],{9113:function(e,t,s){s.d(t,{OD:()=>r,Qi:()=>l,Z7:()=>n,_h:()=>a,dn:()=>i});let l=async e=>{let t=await fetch("http://localhost:3000/symbols",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})});if(!t.ok)throw Error("Network response was not ok");return t.json()},n=async e=>{let t=await fetch(`http://localhost:3000/symbols/${e}`);if(!t.ok)throw Error("Network response was not ok");return t.json()},a=async e=>{let t=await fetch(`http://localhost:3000/symbols/${e}/match`);if(!t.ok)throw Error("Network response was not ok");return t.json()},r=async e=>{let t=await fetch(`http://localhost:3000/symbols/${e}/asm`);if(!t.ok)throw Error("Network response was not ok");return await t.json()},i=async function(e,t,s,l,n){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"length",i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"desc",o=await fetch(`http://localhost:3000/symbols/${e}/submatch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({window_size:a,start:t,end:s,page_num:l,page_size:n,sort_by:r,sort_dir:i})});if(!o.ok)throw Error("Network response was not ok");return await o.json()}},8461:function(e,t,s){s.d(t,{m:()=>a});var l=s(7073),n=s(8772);function a(e){let{symbol:t,link:s=!0}=e,a=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("b",{children:t.name})," - ",t.project_name,t.version_name?` (${t.version_name})`:""]});return s?(0,l.jsx)(n.rU,{to:"/symbol/$symbolSlug",params:{symbolSlug:t.slug},children:a}):a}},2126:function(e,t,s){s.r(t),s.d(t,{component:()=>f});var l=s(7073),n=s(5788),a=s(350),r=s(9113),i=s(5608);let o=e=>{let{asm:t,selectedRange:s,setSelectedRange:n}=e,[a,r]=(0,i.useState)({start:null,end:null}),[o,d]=(0,i.useState)(!1),[c,h]=(0,i.useState)(""),[u,x]=(0,i.useState)(""),[p,g]=(0,i.useState)(!1);(0,i.useEffect)(()=>{s?(h((s.start+1).toString()),x((s.end+1).toString()),r({start:s.start,end:s.end})):(h(null!==a.start?(a.start+1).toString():""),x(null!==a.end?(a.end+1).toString():""))},[s,a]);let m=(0,i.useCallback)(e=>{if(null===a.start)r({start:e,end:null}),d(!0);else if(null===a.end&&o){let t=a.start,s={start:Math.min(t,e),end:Math.max(t,e)};r(s),n(s),d(!1)}else r({start:e,end:null}),n(null),d(!0)},[a,o,n]),y=(0,i.useCallback)(()=>{r({start:null,end:null}),n(null),d(!1)},[n]),j=(0,i.useCallback)(e=>{let s=e.replace(/[^0-9]/g,"");h(s);let l=Number.parseInt(s,10);if(!Number.isNaN(l)&&l>=1){let e=l>t.length?t.length-1:l-1;l>t.length&&h(t.length.toString());let s={...a,start:e};r(s),null!==s.end?n({start:Math.min(e,s.end),end:Math.max(e,s.end)}):n(null)}else""===s&&(r({...a,start:null}),n(null))},[t.length,a,n]),b=(0,i.useCallback)(e=>{let s=e.replace(/[^0-9]/g,"");if(s.startsWith("0"))return;x(s);let l=Number.parseInt(s,10);if(!Number.isNaN(l)&&l>=1){let e=l>t.length?t.length-1:l-1;l>t.length&&x(t.length.toString());let s={...a,end:e};r(s),null!==s.start?n({start:Math.min(s.start,e),end:Math.max(s.start,e)}):n(null)}else""===s&&(r({...a,end:null}),n(null))},[t.length,a,n]),f=(0,i.useCallback)(e=>{let t=s||a;if(!t||null===t.start&&null===t.end)return!1;if(null!==t.start&&null===t.end)return e===t.start;if(null!==t.start&&null!==t.end){let s=Math.min(t.start,t.end),l=Math.max(t.start,t.end);return e>=s&&e<=l}return!1},[s,a]),v=(0,i.useCallback)(()=>{g(e=>!e)},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{children:"Search range:"}),(0,l.jsxs)("div",{style:{fontFamily:"monospace",fontSize:"14px"},children:[(0,l.jsxs)("div",{style:{marginBottom:"10px",display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:(0,l.jsxs)("label",{children:["Start:",(0,l.jsx)("input",{type:"text",value:c,onChange:e=>j(e.target.value),placeholder:"1",style:{width:"40px",padding:"2px 4px",fontFamily:"monospace",fontSize:"12px"}})]})}),(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:(0,l.jsxs)("label",{children:["End:",(0,l.jsx)("input",{type:"text",value:u,onChange:e=>b(e.target.value),placeholder:t.length.toString(),style:{width:"40px",padding:"2px 4px",fontFamily:"monospace",fontSize:"12px"}})]})}),(0,l.jsx)("button",{type:"button",onClick:y,disabled:null===s&&null===a.start&&null===a.end,children:"Reset selection"})]}),(0,l.jsxs)("button",{type:"button",onClick:v,style:{display:"flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"4px",cursor:"pointer"},children:[(0,l.jsx)("span",{style:{transform:p?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease",fontSize:"12px"},children:"â–¶"}),p?"Collapse":"Show asm"]}),p&&(0,l.jsx)("div",{style:{border:"1px solid #ccc",borderRadius:"4px",maxHeight:"500px",overflowY:"auto",backgroundColor:"#640d0dff"},children:t.map((e,s)=>(0,l.jsxs)("div",{role:"button",tabIndex:s,onClick:()=>m(s),style:{padding:"4px 8px",borderBottom:s<t.length-1?"1px solid #eee":"none",cursor:"pointer",backgroundColor:f(s)?"#bc8334ff":"transparent",display:"flex",alignItems:"center"},onMouseEnter:e=>{f(s)||(e.currentTarget.style.backgroundColor="#640d0dff")},onMouseLeave:e=>{f(s)||(e.currentTarget.style.backgroundColor="transparent")},children:[(0,l.jsx)("span",{style:{minWidth:"40px",color:"#666",marginRight:"10px",textAlign:"right",userSelect:"none"},children:s+1}),(0,l.jsxs)("span",{style:{minWidth:"40px",color:"#666",marginRight:"10px",textAlign:"right",userSelect:"none"},children:["0x",(4*s).toString(16).padStart(Math.floor(Math.log2(t.length+1)/4)+2,"0")]}),(0,l.jsx)("span",{style:{userSelect:"none"},children:e})]},s+e))})]})]})};var d=s(4633),c=s(3373),h=s(2039),u=s(6742),x=s(6894),p=s(4497);function g(e){let{min:t,max:s,value:n,onChange:a}=e;return(0,l.jsxs)(d.l,{min:t,max:s,value:n,onValueCommitted:a,className:"Root-Cmfv5e",children:[(0,l.jsx)(c.z,{className:"Control-ldQLuN",children:(0,l.jsxs)(h.U,{className:"Track-DSu3Rf",children:[(0,l.jsx)(u.Q,{className:"Indicator-lcWxkr"}),(0,l.jsx)(x.g,{className:"Thumb-JPHcHP"})]})}),(0,l.jsx)(p.Q,{})]})}var m=s(8461);function y(e){let{submatch:t,querySym:s}=e,n=s.len,a=t.symbol.len,r=t.query_start/n,i=t.len/n,o=t.match_start/a,d=t.len/a;return(0,l.jsxs)("div",{className:"submatch-card",style:{background:"#2c2f33",border:"1px solid #23272a",borderRadius:"6px",padding:"8px 12px",marginBottom:"8px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"},children:[(0,l.jsxs)("div",{style:{fontSize:"1rem",fontWeight:"bold",color:"#ffb347",marginBottom:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)(m.m,{symbol:t.symbol}),(0,l.jsx)("span",{style:{fontSize:"0.8rem",color:"#aaa"}})]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,l.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,l.jsxs)("svg",{width:"30px",height:"100px",children:[(0,l.jsx)("title",{children:"Query Match"}),(0,l.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",style:{fill:"tan",stroke:"black"}}),(0,l.jsx)("rect",{x:"5%",y:`${100*r}%`,width:"90%",height:`${100*i}%`,style:{fill:"saddlebrown"}})]}),(0,l.jsxs)("svg",{width:"30px",height:"100px",children:[(0,l.jsx)("title",{children:"Match Match lol"}),(0,l.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",style:{fill:"tan",stroke:"black"}}),(0,l.jsx)("rect",{x:"5%",y:`${100*o}%`,width:"90%",height:`${100*d}%`,style:{fill:"saddlebrown"}})]})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"70px 1fr",rowGap:"2px",fontSize:"0.9rem",flexGrow:1},children:[(0,l.jsx)("span",{children:"Length:"}),(0,l.jsxs)("span",{children:[t.len," "]}),(0,l.jsx)("span",{children:"Query:"}),(0,l.jsxs)("span",{children:[t.query_start," - ",t.query_start+t.len," (",i.toLocaleString(void 0,{style:"percent",maximumFractionDigits:2}),")"]}),(0,l.jsx)("span",{children:"Match:"}),(0,l.jsxs)("span",{children:[t.match_start," - ",t.match_start+t.len," (",d.toLocaleString(void 0,{style:"percent",maximumFractionDigits:2}),")"]})]})]})]},`${t.symbol.slug}_${t.query_start}_${t.match_start}_${t.len}`)}function j(e){let{querySym:t,submatches:s}=e,n=s.sort((e,t)=>t.len-e.len);return(0,l.jsx)(l.Fragment,{children:0===n.length?(0,l.jsx)("p",{children:"No submatches found."}):(0,l.jsx)("div",{className:"submatch-list",children:n.map(e=>(0,l.jsx)(y,{submatch:e,querySym:t},`${e.symbol.slug}_${e.query_start}_${e.match_start}_${e.len}`))})})}var b=s(1562);let f=function(){let{symbolSlug:e}=b.A.useParams(),t=b.A.useSearch(),s=b.A.useNavigate(),{data:i,isLoading:d,isError:c,error:h}=(0,n.a)({queryKey:["asm",e],queryFn:()=>(0,r.OD)(e),staleTime:3e5}),u=(null==i?void 0:i.asm.length)?i.asm.length-1:0,{data:x,isLoading:p,isError:y,error:f}=(0,n.a)({queryKey:["metadata",e],queryFn:()=>(0,r.Z7)(e),staleTime:3e5}),v=t.end??u,{data:w,isLoading:S,isError:k,error:C,isPlaceholderData:_}=(0,n.a)({queryKey:["symbol_submatches",e,t.start??0,v,t.windowSize??10,t.page,t.sortBy,t.sortDir,10],queryFn:()=>(0,r.dn)(e,t.start??0,v,t.page,10,t.windowSize??10,t.sortBy,t.sortDir),placeholderData:a.Wk,enabled:!!i}),N=e=>{s({search:t=>({...t,page:e})})},M=w?Math.ceil(w.total_count/10):0,$=!!w&&(t.page+1)*10<w.total_count;return p?(0,l.jsx)("div",{children:"Loading query metadata..."}):d?(0,l.jsx)("div",{children:"Loading query assembly..."}):y?(0,l.jsx)("div",{style:{color:"red"},children:f.message}):c?(0,l.jsx)("div",{style:{color:"red"},children:h.message}):k?(0,l.jsx)("div",{style:{color:"red"},children:C.message}):x?i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h2",{children:["Submatches for ",(0,l.jsx)(m.m,{symbol:x,link:!1})]}),(0,l.jsx)(o,{asm:i.asm,selectedRange:null,setSelectedRange:e=>{s({search:t=>({...t,start:(null==e?void 0:e.start)??0,end:null==e?void 0:e.end,page:0}),replace:!0})}}),(0,l.jsx)("div",{style:{marginBottom:"10px",display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[(0,l.jsx)("span",{children:"Minimum match length:"}),(0,l.jsx)(g,{min:8,max:50,defaultValue:t.windowSize??10,onChange:e=>{s({search:t=>({...t,windowSize:e,page:0}),replace:!0})}})]})}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[(0,l.jsx)("span",{children:"Sort by:"}),(0,l.jsxs)("select",{value:t.sortBy,onChange:e=>{var t;return t=e.target.value,void s({search:e=>({...e,sortBy:t})})},children:[(0,l.jsx)("option",{value:"length",children:"Length"}),(0,l.jsx)("option",{value:"query_start",children:"Query start"})]}),(0,l.jsx)("span",{children:"Sort direction:"}),(0,l.jsxs)("select",{value:t.sortDir,onChange:e=>{var t;return t=e.target.value,void s({search:e=>({...e,sortDir:t})})},children:[(0,l.jsx)("option",{value:"asc",children:"Ascending"}),(0,l.jsx)("option",{value:"desc",children:"Descending"})]})]}),(0,l.jsx)("br",{}),(0,l.jsxs)("h3",{children:["Search results (",(null==w?void 0:w.total_count)||0," total)",S&&(0,l.jsx)("span",{children:" (Loading...)"})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,l.jsx)("button",{type:"button",onClick:()=>N(Math.max(t.page-1,0)),disabled:0===t.page,children:"Previous Page"}),(0,l.jsx)("button",{type:"button",onClick:()=>N(t.page+1),disabled:_||!$,children:"Next Page"}),(0,l.jsxs)("span",{children:["Page ",t.page+1," of ",M]})]}),w&&(0,l.jsx)(j,{querySym:x,submatches:w.submatches})]}):(0,l.jsx)("div",{style:{color:"red"},children:"Query assembly data could not be loaded"}):(0,l.jsx)("div",{style:{color:"red"},children:"Query symbol data could not be loaded"})}}}]);